# -*- coding: utf-8 -*-import requests# import timeimport jsonimport csvimport timeimport randomf = open('houlang_comment.csv','a+',encoding='utf-8-sig', newline='')l = '评论,点赞,id,昵称,性别,评论时间'+'\n'w=csv.writer(f)f.write(l)headers={        'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36',        'Referer': 'https://www.bilibili.com/video/BV1FV411d7u7?from=search&seid=9323669094129958607',        'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',    }for n in range(1,201):    print('开始爬取第',n,'页')    url = 'https://api.bilibili.com/x/v2/reply?callback=jQuery17204013375014958447_1608100247624&jsonp=jsonp&pn='+str(n)+'&type=1&oid=412935552&sort=2&_=1608100275897'    r = requests.get(url,headers=headers)    da=json.loads(r.text[41:-1])['data']      replies=da['replies']    for i in replies:        ls = []        comment = i['content']['message'].replace(',',' ').replace('_','').replace('\n','')        like_count = i['like']        mid = i['member']['mid']        name = i['member']['uname']        sex = i['member']['sex']        d=i['ctime']         data = time.strftime('%Y/%m/%d %H:%M:%S',time.localtime(d))  #10位的时间戳,需要time.locltime()          try:            w.writerow((comment,like_count,mid,name,sex,data))        except:            continue    time.sleep(random.random()*3)   print('你好')f.close()           